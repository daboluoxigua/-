(function(t){function e(e){for(var o,n,r=e[0],c=e[1],d=e[2],u=0,h=[];u<r.length;u++)n=r[u],s[n]&&h.push(s[n][0]),s[n]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(e);while(h.length)h.shift()();return a.push.apply(a,d||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],o=!0,r=1;r<i.length;r++){var c=i[r];0!==s[c]&&(o=!1)}o&&(a.splice(e--,1),t=n(n.s=i[0]))}return t}var o={},s={app:0},a=[];function n(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=o,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var d=0;d<r.length;d++)e(r[d]);var l=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0409":function(t,e,i){},"044c":function(t,e,i){"use strict";var o=i("7911"),s=i.n(o);s.a},"0aed":function(t,e,i){"use strict";var o=i("2bd6"),s=i.n(o);s.a},1292:function(t,e,i){"use strict";var o=i("c4c2"),s=i.n(o);s.a},"159a":function(t,e,i){"use strict";var o=i("9b6b"),s=i.n(o);s.a},"1be2":function(t,e,i){},"2bd6":function(t,e,i){},"2c49":function(t,e,i){},"3b15":function(t,e,i){"use strict";var o=i("9091"),s=i.n(o);s.a},"40cb":function(t,e,i){},"457e":function(t,e,i){"use strict";var o=i("40cb"),s=i.n(o);s.a},"4d52":function(t,e,i){},5242:function(t,e,i){"use strict";var o=i("1be2"),s=i.n(o);s.a},"54a1":function(t,e,i){"use strict";var o=i("6c23"),s=i("96f7"),a=(i("159a"),i("2877")),n=Object(a["a"])(s["default"],o["a"],o["b"],!1,null,null,null);n.options.__file="loading.vue",e["default"]=n.exports},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("097d");var o=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("transition",{attrs:{name:t.transitionName}},[i("keep-alive",[i("router-view",{key:t.$route.fullPath,staticClass:"Router"})],1)],1)],1)},a=[],n=(i("a481"),i("ac6a"),i("bc3a")),r=i.n(n),c=i("4328"),d=i.n(c),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav"},[i("div",{staticClass:"nav-left",on:{click:t.routerback}},[i("i",{staticClass:"iconfont"},[t._v("")])]),i("h2",[t._v(t._s(t.title))])])},u=[],h={props:["title"],methods:{routerback:function(){return window.history.length<=1?(this.$router.push({path:"/"}),!1):(this.$router.go(-1),!1)}}},p=h,m=(i("b315"),i("2877")),f=Object(m["a"])(p,l,u,!1,null,null,null);f.options.__file="navTop.vue";var g=f.exports,v=(i("386d"),i("6b54"),i("4917"),i("3b2b"),i("28a5"),i("18a0")),w=i.n(v),_=function(t){var e=window.location.href.split("?")[1];if(e){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),o=e.match(i);return null!=o?decodeURIComponent(o[2]):null}},b={checkLink:function(t,e){r.a.post("../../wx/checkLink",d.a.stringify({tempTime:parseInt(t)})).then(function(t){var i=t.data;0==i.result?e(i):alert(i.errmsg)})},getStoreById:function(t,e,i,o){r.a.post("../../wx/getStoreById",d.a.stringify({appid:t,brandid:parseInt(e),storeid:parseInt(i)})).then(function(t){var e=t.data;0==e.result?o(e):alert(e.errmsg)})},getTableById:function(t,e,i,o){r.a.post("../../wx/getTableById",d.a.stringify({appid:t,brandid:parseInt(e),storeid:parseInt(i),tableid:window.sessionStorage.getItem("table")})).then(function(t){var e=t.data;0==e.result?o(e):alert(e.errmsg)})},getWechatAppID:function(t,e,i,o,s,a){var n={appid:t,brandid:parseInt(e),storeid:parseInt(i),tableid:parseInt(o)};1==window.localStorage.getItem("browserName")&&(n.type=1),r.a.post("../../wx/getWechatAppID",d.a.stringify(n)).then(function(t){var e=t.data;0==e.result?a(e):alert(e.errmsg)})},getJSParam:function(t,e,i){r.a.post("../../wx/getJSParam",d.a.stringify({appid:t,brandid:parseInt(e),storeid:parseInt(i),shareurl:window.location.href})).then(function(t){var e=t.data,i=window.sessionStorage.getItem("appID");0==e.result?w.a.config({debug:!1,appId:i,timestamp:e.content.timestamp,nonceStr:e.content.noncestr,signature:e.content.sign,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","scanQRCode","chooseWXPay"]}):alert(e.errmsg)})},getOpenid:function(t,e,i,o,s){var a=window.localStorage.getItem("browserName");function n(t){var e=t.data;0==e.result?(window.localStorage.setItem("nickname",e.content.nickname),window.localStorage.setItem("headimgurl",e.content.headimgurl),1==a?window.sessionStorage.setItem("openid",e.content.userid):2==a&&(window.sessionStorage.setItem("openid",e.content.openid),window.localStorage.setItem("subscribe",e.content.subscribe.toString().substring(0,1))),s()):2==a&&I(_("appid"),_("brandid"),_("storeid"),_("dishtype"),_("table"),sessionStorage.getItem("appID"))}1==a&&r.a.post("../../alipay/getUserid",d.a.stringify({appid:t,code:i,storeid:parseInt(o)})).then(function(t){n(t)}),2==a&&r.a.post("../../wx/getOpenid",d.a.stringify({appid:t,code:i,brandid:e,storeid:parseInt(o)})).then(function(t){n(t)})}},y="/wxdc/dist/",C=/production/.test(window.location.href);C&&(y="/wxdc/wxdd/production/");var I=function(t,e,i,o,s,a){var n=location.protocol+"//"+window.location.host;n+=y+"index.html?appid="+t+"&brandid="+parseInt(e)+"&storeid="+parseInt(i)+"&dishtype="+o+"&table="+s,window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+a+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect"},F=function(t,e,i,o,s,a){var n=location.protocol+"//"+window.location.host;n+=y+"index.html?appid="+t+"&brandid="+parseInt(e)+"&storeid="+parseInt(i)+"&dishtype="+o+"&table="+s+"&code=1",window.location.href="https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id="+a+"&scope=auth_user&redirect_uri="+encodeURIComponent(n)},S=function(){var t=navigator.userAgent.toLowerCase();"alipay"!=t.match(/Alipay/i)?"micromessenger"!=t.match(/MicroMessenger/i)?window.localStorage.setItem("browserName",3):window.localStorage.setItem("browserName",2):window.localStorage.setItem("browserName",1)};S();var x=b,k=x.checkLink,L=x.getStoreById,N=x.getWechatAppID,P=x.getTableById,$=_,D=I,q=F,E=$("openid"),O=function(){window.localStorage.setItem("appid",$("appid")),window.localStorage.setItem("storeid",$("storeid")),window.localStorage.setItem("brandid",$("brandid")),window.sessionStorage.setItem("dishtype",$("dishtype")),window.sessionStorage.setItem("table",$("table")),$("code")||T()},T=function(){2==$("dishtype")?M():j()},M=function(){var t=!!$("tempTime")&&$("tempTime");t?k($("tempTime"),function(t){t.data?A():(alert("链接已过期请重新扫码"),setTimeout(function(){WeixinJSBridge.call("closeWindow")},200))}):A()},j=function(){N($("appid"),$("brandid"),$("storeid"),$("table"),$("dishtype"),function(t){window.sessionStorage.setItem("appID",t.content.appid),window.localStorage.setItem("tableName",t.content.tableName),E&&(window.sessionStorage.setItem("openid",$("openid")),P($("appid"),$("brandid"),$("storeid"),function(t){0==t.result?(window.localStorage.setItem("tableName",t.content.tableName),window.location.href=window.location.origin+window.location.pathname+window.location.search+"&code=1"):alert(t.errmsg)})),1!=window.localStorage.getItem("browserName")||E?2!=window.localStorage.getItem("browserName")||E||D($("appid"),$("brandid"),$("storeid"),$("dishtype"),$("table"),t.content.appid):q($("appid"),$("brandid"),$("storeid"),$("dishtype"),$("table"),t.content.appid)})},A=function(){L($("appid"),$("brandid"),$("storeid"),function(t){0==t.result&&(window.localStorage.setItem("displayIndex",t.data.displayIndex),window.localStorage.setItem("toggle",t.data.toggle),window.localStorage.setItem("cache",t.data.cache),window.localStorage.setItem("point",[t.data.longitude,t.data.latitude]),window.localStorage.setItem("saleOut",t.data.saleOut),window.localStorage.setItem("welcomeSname",t.data.sname),window.localStorage.setItem("welcomeStoreImg",t.data.storeImg),window.localStorage.setItem("repastPopulation",t.data.repastPopulation),window.localStorage.setItem("isNeedMember",t.data.needMember),window.localStorage.setItem("showMemberPrice",t.data.showMemberPrice),window.localStorage.setItem("isPayRecommended",t.data.isPayRecommended),window.localStorage.setItem("recommend",t.data.recommend),j())})};O();var B=b,U=B.getOpenid,R=B.getJSParam,z=_,K={name:"app",data:function(){return{transitionName:"slide-right"}},components:{navTop:g},watch:{$route:function(t,e){var i=this.$router.isBack;this.transitionName=i?"slide-right":"slide-left",this.$router.isBack=!1}},mounted:function(){document.title=window.localStorage.getItem("welcomeSname"),z("code")&&(R(z("appid"),z("brandid"),z("storeid")),this.getOpen())},methods:{getOpen:function(){if(window.sessionStorage.getItem("openid"))this.findOrder();else{var t=window.localStorage.getItem("browserName");1==t?U(z("appid"),z("brandid"),z("code"),z("storeid"),this.findOrder):2==t&&U(z("appid"),z("brandid"),z("code"),z("storeid"),this.findOrder)}},findOrder:function(){var t=this;r.a.post("../../wx/findOrder",d.a.stringify({appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),openid:window.sessionStorage.getItem("openid"),brandid:window.localStorage.getItem("brandid")})).then(function(e){var i=e.data;0==i.result&&(i.content.length>0?(i.content.forEach(function(t){window.sessionStorage.setItem("phoneNum",t.memberPhoneNumber)}),t.$router.push({path:"/orderListAgain"})):t.onJump())})},onJump:function(){var t=window.localStorage.getItem("displayIndex");this.$route.query;"true"==t?this.$router.replace({path:"/welcome"}):this.$router.replace({path:"/goods"})}}},W=K,H=(i("7c55"),Object(m["a"])(W,s,a,!1,null,null,null));H.options.__file="App.vue";var J=H.exports;document.write('<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />');var G=i("8c4f"),Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hello"},[2==t.browserName?i("div",{staticClass:"userinfo"},[i("img",{attrs:{src:t.headimgurl,alt:""}}),i("p",[t._v(t._s(t.nickname))])]):i("input",{ref:"phoneNum",attrs:{type:"number",min:"11",max:"11",placeholder:"请输入手机号码"}}),i("button",{staticClass:"btn",on:{click:function(e){t.routerTo()}}},[t._v("开始点餐")])])},X=[],Q={data:function(){return{headimgurl:""}},created:function(){this.headimgurl=window.localStorage.getItem("headimgurl"),this.nickname=window.localStorage.getItem("nickname"),this.browserName=window.localStorage.getItem("browserName")},methods:{routerTo:function(){var t=this;if(1==this.browserName){var e=this.$refs.phoneNum.value;if(e){if(!/^1[34578]\d{9}$/.test(e))return alert("手机号码有误,请重填"),!1;r.a.get("/public/members/getMemberInfo",{params:{appId:window.localStorage.getItem("appid"),storeId:window.localStorage.getItem("storeid"),brandId:window.localStorage.getItem("brandid"),account:e}}).then(function(i){var o=i.data;if(null==o.content)return alert("请输入正确的会员手机号码"),!1;window.sessionStorage.setItem("phoneNum",e);var s=window.localStorage.getItem("repastPopulation");s&&"false"!=s||t.$router.replace({path:"/goods"})})}}this.$router.push({name:"goods"})}}},Z=Q,V=(i("0aed"),Object(m["a"])(Z,Y,X,!1,null,"376128ae",null));V.options.__file="welcome.vue";var tt=V.exports,et=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"goods"},[o("div",{staticClass:"goodsbox"},[o("div",{ref:"banner",staticClass:"banner"},[o("mt-swipe",{staticClass:"banner",attrs:{auto:4e3}},t._l(t.banner,function(t,e){return o("mt-swipe-item",{key:e},[o("img",{attrs:{src:t,alt:""}})])}))],1),o("div",{ref:"wrapper",staticClass:"wrapper"},[o("div",{ref:"menuWrapper",staticClass:"menu-wrapper"},[o("ul",t._l(t.data,function(e,i){return o("li",{key:i,ref:"menuList",refInFor:!0,staticClass:"menu-item",class:{current:t.currentIndex===i},on:{click:function(e){t.selectMenu(i,e)}}},[o("span",{staticClass:"text"},[t._v(t._s(e.kindName))]),e.count&&e.count>0?o("span",{staticClass:"num"},[t._v(t._s(e.count))]):t._e()])}))]),o("div",{ref:"foodsWrapper",staticClass:"foods-wrapper"},[o("ul",t._l(t.data,function(e,s){return o("li",{key:s,ref:"foodList",refInFor:!0,staticClass:"food-list"},[o("h1",{staticClass:"title"},[t._v(t._s(e.kindName))]),o("ul",t._l(e.dishData,function(e,s){return o("li",{key:s,staticClass:"food-item",on:{click:function(i){t.selectFood(e,i)}}},[o("div",{staticClass:"icon"},[e.imageName?o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imageName,expression:"food.imageName"}],attrs:{width:"57",height:"57"}}):o("img",{attrs:{width:"57",height:"57",src:i("e0e4")}})]),o("div",{staticClass:"content"},[o("h2",{staticClass:"name"},[t._v(t._s(e.dishName))]),o("div",{staticClass:"extra"},[o("span",{staticClass:"count"},[t._v("销量"+t._s(e.salesCount)+"份")]),e.memberPrice&&"true"==t.showMemberPrice?o("span",[t._v("会员价￥"+t._s(e.memberPrice))]):t._e()]),o("div",{staticClass:"price"},[o("span",{staticClass:"now"},[t._v("￥"+t._s(e.price))])]),o("div",{staticClass:"cartcontrol-wrapper"},[o("cartcontrol",{attrs:{food:e},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}})],1)])])}))])}))])])]),o("shopcart",{ref:"shopcart",attrs:{data:t.data,selectFoods:t.selectFoods},on:{getReco:t.recommendedGo}}),o("setCourese",{ref:"setCourese",attrs:{selectFoods:t.foodItems,target:t.target},on:{addCustom:function(e){t.addCustom(arguments)}}}),o("foodcustom",{ref:"foodcustom",attrs:{selectFoods:t.foodItems,target:t.target},on:{addCustom:function(e){t.addCustom(arguments)}}}),o("food",{ref:"food",attrs:{food:t.selectedFood,data:t.data},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}}),o("recommended",{ref:"recommended",attrs:{data:t.data},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}}),t.loading?o("loading"):t._e()],1)},it=[],ot=i("1157"),st=i.n(ot),at=i("76a0"),nt=i.n(at),rt=i("1fba"),ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"slider",staticClass:"slider"},[i("div",{ref:"sliderGroup",staticClass:"slider-group"},[t._t("default")],2),i("div",{staticClass:"dots"},t._l(t.dots,function(e,o){return i("span",{key:o,staticClass:"dot",class:{active:t.currentPageIndex===o}},[t._v(t._s(o)+t._s(t.currentPageIndex))])}))])},dt=[];i("c5f6");function lt(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)");return i.test(t.className)}function ut(t,e){if(!lt(t,e)){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}}var ht=document.createElement("div").style;(function(){var t={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var e in t)if(void 0!==ht[t[e]])return e})();var pt={name:"slider",props:{loop:{type:Boolean,default:!0},autoPlay:{type:Boolean,default:!0},interval:{type:Number,default:4e3}},data:function(){return{dots:[],currentPageIndex:0}},mounted:function(){var t=this;setTimeout(function(){t._setSliderWidth(),t._initDots(),t._initSlider(),t.autoPlay&&t._play()},20),window.addEventListener("resize",function(){t.slider&&(t._setSliderWidth(!0),t.slider.refresh())})},activated:function(){this.autoPlay&&this._play()},deactivated:function(){clearTimeout(this.timer)},beforeDestroy:function(){clearTimeout(this.timer)},methods:{_setSliderWidth:function(t){this.children=this.$refs.sliderGroup.children;for(var e=0,i=this.$refs.slider.clientWidth,o=0;o<this.children.length;o++){var s=this.children[o];ut(s,"slider-item"),s.style.width=i+"px",e+=i}this.loop&&!t&&(e+=2*i),this.$refs.sliderGroup.style.width=e+"px"},_initSlider:function(){var t=this;this.slider=new rt["a"](this.$refs.slider,{scrollX:!0,scrollY:!1,momentum:!1,snap:{loop:this.loop,threshold:.3,speed:400}}),this.slider.on("scrollEnd",function(){var e=t.slider.getCurrentPage().pageX;t.currentPageIndex=e,t.autoPlay&&t._play()}),this.slider.on("beforeScrollStart",function(){t.autoPlay&&clearTimeout(t.timer)})},_initDots:function(){this.dots=new Array(this.children.length)},_play:function(){var t=this,e=this.currentPageIndex+1;this.loop&&(e+=1),this.timer=setTimeout(function(){t.slider.goToPage(e,0,400)},this.interval)}}},mt=pt,ft=(i("6d40"),Object(m["a"])(mt,ct,dt,!1,null,"55b743ac",null));ft.options.__file="slider.vue";var gt=ft.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cartcontrol"},[0==t.food.dishCount?i("div",{staticClass:"shouqing"},[t._v("售罄")]):i("div",[i("transition",{attrs:{name:"move"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.food.quantity>0,expression:"food.quantity>0"}],staticClass:"cart-decrease",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.decreaseCart(e)}}},[i("span",{staticClass:"inner iconfont icon-jianhao"})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.food.quantity>0,expression:"food.quantity>0"}],staticClass:"cart-quantity"},[t._v(t._s(t.food.quantity))]),t.food.maxitemCount?t._e():i("div",{staticClass:"cart-add iconfont icon-jiahao1",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addCart(e)}}}),t.itemCount-t.food.maxitemCount>0?i("div",{staticClass:"cart-add iconfont icon-jiahao1",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addCart(e)}}}):t._e()],1)])},wt=[],_t={props:{food:{},itemCount:{default:1}},methods:{addCart:function(t){if(this.food.add)if(this.food.quantity){var e=this.food.quantity+1;o["default"].set(this.food,"quantity",e)}else o["default"].set(this.food,"quantity",1);this.$emit("addFood",this.food,t.target),this.$emit("add",t.target),this.$forceUpdate()},decreaseCart:function(t){this.food.quantity&&this.$emit("DeletFood",this.food),this.$forceUpdate()}}},bt=_t,yt=(i("3b15"),Object(m["a"])(bt,vt,wt,!1,null,null,null));yt.options.__file="cartcontrol.vue";var Ct=yt.exports,It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"shopcart"},[i("div",{staticClass:"content",on:{click:t.toggleList}},[i("div",{staticClass:"content-left"},[i("div",{staticClass:"logo-wrapper"},[i("div",{staticClass:"logo",class:{highlight:t.totalCount>0}},[i("i",{staticClass:"iconfont icon-gouwuche2",class:{highlight:t.totalCount>0}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.totalCount>0,expression:"totalCount>0"}],staticClass:"num"},[t._v(t._s(t.totalCount))])]),i("div",{staticClass:"price",class:{highlight:t.totalPrice>0}},[t._v("￥"+t._s(t.totalPrice))])]),i("div",{staticClass:"content-right",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.pay(e)}}},[i("div",{staticClass:"pay",class:t.payClass},[t._v("\n          "+t._s(t.payDesc)+"\n        ")])])]),i("div",{staticClass:"ball-container"},t._l(t.balls,function(e,o){return i("div",{key:o},[i("transition",{attrs:{name:"drop"},on:{"before-enter":t.beforeDrop,enter:t.dropping,"after-enter":t.afterDrop}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"ball.show"}],staticClass:"ball"},[i("div",{staticClass:"inner inner-hook"})])])],1)})),i("transition",{attrs:{name:"fold"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"shopcart-list"},[i("div",{staticClass:"list-header"},[i("h1",{staticClass:"title"},[t._v("购物车")]),i("span",{staticClass:"empty",on:{click:t.empty}},[t._v("清空")])]),i("div",{ref:"listContent",staticClass:"list-content"},[i("ul",t._l(t.selectFoods,function(e,o){return i("li",{key:o,staticClass:"food"},[i("span",{staticClass:"name"},[t._v(t._s(e.dishName))]),i("div",{staticClass:"price"},[i("span",[t._v("￥"+t._s(parseFloat((e.cost*e.quantity).toFixed(2))))])]),i("div",{staticClass:"cartcontrol-wrapper"},[i("cartcontrol",{attrs:{food:e},on:{add:t.addFood,addFood:t.addFoodList,DeletFood:t.DeletFood}})],1),i("div",{staticClass:"option"},[t._l(e.optionList,function(o,s){return e.optionList?i("span",{key:s},[t._v("\n                    "+t._s(o.optionName)+" "),o.cost>0?i("em",[t._v("(+￥"+t._s(o.cost)+")")]):t._e(),t._v("; \n                  ")]):t._e()}),t._l(e.subItemList,function(o,s){return e.subItemList?i("span",{key:s},[t._v("\n                    "+t._s(o.dishName)+" "),o.quantity>1?i("em",[t._v(t._s(o.quantity)+" X "+t._s(o.unit))]):t._e(),o.price>0?i("em",[t._v("(+￥"+t._s(o.price)+")")]):t._e(),t._v("; \n                  ")]):t._e()})],2)])}))])])])],1),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"list-mask",on:{click:t.hideList}})])],1)},Ft=[],St=i("be94"),xt=i("2f62");o["default"].use(xt["a"]);var kt={selectFoods:{},totalPrice:0,addressInfo:{}},Lt={set_selectFoods:function(t,e){t.selectFoods=e},set_totalPrice:function(t,e){t.totalPrice=e},set_addressInfo:function(t,e){t.addressInfo=e}},Nt={get_selectFoods:function(t){return t.selectFoods},get_totalPrice:function(t){return t.totalPrice},get_addressInfo:function(t){return t.addressInfo}},Pt=new xt["a"].Store({getters:Nt,state:kt,mutations:Lt}),$t=(i("aabe"),{props:{data:{},selectFoods:{type:Array,default:function(){return[{price:10,count:1}]}},deliveryPrice:{type:Number,default:0},minPrice:{type:Number,default:0}},data:function(){return{balls:[{show:!1},{show:!1},{show:!1},{show:!1},{show:!1}],dropBalls:[],fold:!0,first:!0}},computed:{totalPrice:function(){var t=0;return this.selectFoods.forEach(function(e){t+=e.cost*e.quantity}),t=parseFloat(t.toFixed(2)),this.set_totalPrice(t),t},totalCount:function(){var t=0;return this.selectFoods.forEach(function(e,i){!e.quantity>0||(t+=e.quantity)}),t},payDesc:function(){return 0===this.selectFoods.length?"未选购":"去结算"},payClass:function(){return this.totalPrice<this.minPrice?"not-enough":"enough"},listShow:function(){var t=this;if(!this.totalCount)return this.fold=!0,!1;var e=!this.fold;return e&&this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.listContent,{click:!0})}),e}},methods:Object(St["a"])({},Object(xt["c"])(["set_selectFoods","set_totalPrice"]),{drop:function(t){for(var e=0;e<this.balls.length;e++){var i=this.balls[e];if(!i.show)return i.show=!0,i.el=t,void this.dropBalls.push(i)}},toggleList:function(){this.totalCount&&(this.fold=!this.fold)},hideList:function(){this.fold=!0},empty:function(){this.selectFoods.splice(0,this.selectFoods.length),this.data.forEach(function(t){t.dishData.forEach(function(t,e){t.quantity>0&&(t.quantity=0)})}),this.$forceUpdate()},pay:function(){if(0!==this.selectFoods.length){if(1==window.localStorage.getItem("isPayRecommended")&&this.first)return this.$emit("getReco","true"),void(this.first=!1);this.set_selectFoods(this.selectFoods),this.$router.push({name:"payPage",query:this.$route.query})}},addFoodList:function(t){this.data.forEach(function(e){e.dishData.forEach(function(e,i){e.dishID==t.dishID&&e.quantity++})})},addFood:function(t){this.drop(t)},beforeDrop:function(t){var e=this.balls.length;while(e--){var i=this.balls[e];if(i.show){var o=i.el.getBoundingClientRect(),s=o.left-62,a=-(window.innerHeight-o.top-42);t.style.display="",t.style.webkitTransform="translate3d(0,".concat(a,"px,0)"),t.style.transform="translate3d(0,".concat(a,"px,0)");var n=t.getElementsByClassName("inner-hook")[0];n.style.webkitTransform="translate3d(".concat(s,"px,0,0)"),n.style.transform="translate3d(".concat(s,"px,0,0)")}}},dropping:function(t,e){t.offsetHeight;this.$nextTick(function(){t.style.webkitTransform="translate3d(0,0,0)",t.style.transform="translate3d(0,0,0)";var i=t.getElementsByClassName("inner-hook")[0];i.style.webkitTransform="translate3d(0,0,0)",i.style.transform="translate3d(0,0,0)",t.addEventListener("transitionend",e)})},afterDrop:function(t){var e=this.dropBalls.shift();e&&(e.show=!1,t.style.display="none")},DeletFood:function(t){var e=this;this.data.forEach(function(e){e.dishData.forEach(function(e,i){e.dishID==t.dishID&&(e.quantity--,t.quantity--)})}),this.selectFoods.forEach(function(t,i,o){!t.quantity>0&&e.selectFoods.splice(i,1)})}}),components:{cartcontrol:Ct}}),Dt=$t,qt=(i("457e"),Object(m["a"])(Dt,It,Ft,!1,null,"2abcd3d4",null));qt.options.__file="shopcart.vue";var Et=qt.exports,Ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"move"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"food"},[o("div",{staticClass:"back",on:{click:t.hide}},[o("i",{staticClass:"iconfont icon-close2"})]),o("div",{ref:"food",staticClass:"foodbox"},[o("div",[o("div",{staticClass:"food-content"},[o("div",{staticClass:"image-header"},[t.food.imageName?o("img",{attrs:{src:t.food.imageName}}):o("img",{attrs:{src:i("e0e4")}})])]),o("div",{staticClass:"dishInfo"},[o("div",{staticClass:"dishName"},[t._v(t._s(t.food.dishName))]),o("div",{staticClass:"sales"},[t._v("销量"+t._s(t.food.salesCount))]),o("div",{staticClass:"price"},[o("span",[t._v("￥"+t._s(t.food.price))]),o("span",[t._v("会员价 ￥"+t._s(t.food.memberPrice))])]),o("cartcontrol",{attrs:{food:t.food},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}})],1),t.food.comment?o("div",{staticClass:"synopsis"},[t._v(t._s(t.food.comment))]):t._e(),o("div",{staticClass:"split"}),t.recommandList.length>0?o("div",{staticClass:"recommand"},[o("h2",[t._v(t._s(t.reTxt))]),o("ul",t._l(t.recommandList,function(e,s){return o("li",{key:s},[e.imageName?o("img",{attrs:{src:e.imageName,alt:""}}):o("img",{attrs:{src:i("e0e4")}}),o("div",{staticClass:"recoInfo"},[o("div",{staticClass:"dishName"},[t._v(t._s(e.dishName))]),o("div",{staticClass:"sales"},[o("span",[t._v("销量"+t._s(e.salesCount))]),t._v(" "),e.memberPrice?o("span",[t._v("会员价￥"+t._s(e.memberPrice))]):t._e()]),o("div",{staticClass:"price"},[o("span",[t._v("￥"+t._s(e.price))])]),o("cartcontrol",{attrs:{food:e},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}})],1)])}))]):t._e()])])])])},Tt=[],Mt=i("3835"),jt=(i("55dd"),{props:{food:{type:Object},data:{}},data:function(){return{showFlag:!1,foodItems:{},optionList:[],recommandList:[],reTxt:""}},methods:{show:function(){var t=this;this.showFlag=!0,this.$nextTick(function(){t.init(),t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.food,{click:!0})})},hide:function(){this.showFlag=!1},init:function(){var t=this,e=!0;this.recommandList=[],null!==this.food.recommandList&&(this.food.recommandList.forEach(function(i){t.data.forEach(function(o){o.dishData.forEach(function(o){o.dishID==i.packageid&&(t.recommandList.push(o),e=!1)})})}),this.reTxt="相关套餐"),e&&(this.data.forEach(function(e){e.dishData.forEach(function(e){t.recommandList.push(e)})}),this.recommandList.sort(function(t,e){return e.salesCount-t.salesCount}),this.recommandList.length=4,this.reTxt="推荐菜品")},addFoodList:function(t){var e=Object(Mt["a"])(t,2),i=e[0],o=e[1];this.$emit("addFood",i,o)},DeletFood:function(t){this.$emit("DeletFood",t)}},components:{cartcontrol:Ct}}),At=jt,Bt=(i("e673"),Object(m["a"])(At,Ot,Tt,!1,null,"95680e08",null));Bt.options.__file="food.vue";var Ut=Bt.exports,Rt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"move"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"catconfig"},[o("div",{staticClass:"food-content"},[o("div",{staticClass:"back",on:{click:t.hide}},[o("i",{staticClass:"iconfont icon-close2"})]),o("div",{staticClass:"image-header"},[o("div",{staticClass:"imgbox"},[t.selectFoods.imageName?o("img",{attrs:{src:t.selectFoods.imageName}}):o("img",{attrs:{src:i("e0e4")}})]),o("div",{staticClass:"info"},[o("h2",[t._v(t._s(t.selectFoods.dishName))]),o("p",[t._v("已选：\n            "),t._l(t.optionList,function(e,i){return o("span",{key:i},[t._v(t._s(e.dishName)+" "+t._s(e.quantity>1?"x"+e.quantity+e.unit:"")+" "+t._s(e.price>0?"+￥"+parseFloat((e.price*e.quantity).toFixed(2)):"")+" /")])})],2),o("span",{staticClass:"price"},[t._v("\n            ￥"+t._s((t.selectFoods.price+t.totalPrice).toFixed(2))+"\n            "),"true"==t.showMemberPrice?o("em",[t._v("会员价￥"+t._s(parseFloat((t.selectFoods.memberPrice+t.totalPrice).toFixed(2))))]):t._e()])])]),o("div",{ref:"config",staticClass:"config"},[o("div",t._l(t.selectFoods.packageItems,function(e,i){return o("div",{key:i},[o("div",{staticClass:"title"},[e.userdefinedName?o("span",[t._v(t._s(e.userdefinedName+e.itemName.substring(4,e.itemName.length)))]):o("span",[t._v(t._s(e.itemName))])]),o("ul",t._l(e.options,function(i,s){return o("li",{key:s},[o("span",{class:{active:i.isElect},on:{click:function(o){t._elect(i,e,s)}}},[t._v(t._s(i.dishName)+" "+t._s(i.extraCost>0?"￥"+i.extraCost:""))]),e.itemCount>1&&i.isElect?o("cartcontrol",{attrs:{food:i,itemCount:e.itemCount},on:{DeletFood:t.DeletFood,addFood:t.addFoodNum}}):t._e()],1)}))])}))]),o("div",{staticClass:"numconfig"},[o("button",{staticClass:"btn",on:{click:t.addFood}},[t._v("加入购物车")])])]),o("foodcustom",{ref:"foodcustom",attrs:{selectFoods:t.foodItems,courese:t.courese},on:{addCustom:t.addOdd}})],1)])},zt=[],Kt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"move"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"foodcustom"},[o("div",{staticClass:"food-content"},[o("div",{staticClass:"back",on:{click:t.hide}},[o("i",{staticClass:"iconfont icon-close2"})]),o("div",{staticClass:"image-header"},[o("div",{staticClass:"imgbox"},[t.selectFoods.imageName?o("img",{attrs:{src:t.selectFoods.imageName}}):o("img",{attrs:{src:i("e0e4")}})]),o("div",{staticClass:"info"},[o("h2",[t._v(t._s(t.selectFoods.dishName))]),o("p",[t._v("已选："+t._s(t.selectedCustom))]),o("span",[t.selectFoods.price+t.totalPrice>0?o("article",[t._v("￥"+t._s(t.totalPrice>0?t.totalPrice:t.selectFoods.price))]):t._e(),t.selectFoods.memberPrice?o("em",[t._v("会员价"+t._s(t.totalMemberPrice>0?t.totalMemberPrice:t.selectFoods.memberPrice))]):t._e()])])]),o("div",{ref:"configcustom",staticClass:"config"},[o("div",t._l(t.selectFoods.optionCategoryList,function(e,i){return o("div",{key:i},[o("div",{staticClass:"title"},[t._v("\n                    "+t._s(e.optionCategoryName)+" \n                    "),e.minimalOptions>0?o("span",[t._v("必选 "),e.minimalOptions>1?o("span",[t._v("(至少选择"+t._s(e.minimalOptions)+"项)")]):t._e()]):t._e(),e.optionList.length>e.maximalOptions&&1!==e.minimalOptions?o("span",[t._v(" (最多可选"+t._s(e.maximalOptions)+"项)")]):t._e()]),o("ul",t._l(e.optionList,function(i,s){return o("li",{key:s,class:{active:i.isElect},on:{click:function(o){t._elect(i,e,s)}}},[t._v("\n                      "+t._s(i.optionName)+" "+t._s(i.price>0?" +￥"+i.price:"")+"\n                    ")])}))])}))]),o("div",{staticClass:"numconfig"},[o("button",{staticClass:"btn",on:{click:t.addFood}},[t._v(t._s(t.showTxt))])])]),o("div",{staticClass:"list-mask",on:{click:t.hide}})])])},Wt=[],Ht={props:{selectFoods:{},courese:{},target:{}},components:{cartcontrol:Ct},data:function(){return{showFlag:!1,isElect:!1,food:{},numconfigShow:!1,current:"",totalPrice:0,selectedCustom:"",totalMemberPrice:0}},computed:{CshowFlag:function(){this.selectFoods.quantity},showTxt:function(){return 1==this.courese?"加入套餐":"加入购物车"}},methods:{show:function(){var t=this;this.showFlag=!0,this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.configcustom,{click:!0}),t.defaultShow()})},hide:function(){this.showFlag=!1,this.$forceUpdate()},_elect:function(t,e,i){t.isElect=!t.isElect;var s=0;if(e.optionList.forEach(function(t){t.isElect&&s++}),1==e.maximalOptions)e.optionList.forEach(function(t,e,s){t.isElect=!1,e===i?s[i].quantity<=1&&o["default"].set(s[i],"quantity",1):o["default"].set(s[e],"quantity",0)}),t.isElect=!0,o["default"].set(t,"quantity",1);else{if(s>e.maximalOptions)return Object(at["Toast"])({className:"toasts",message:"这类最多只能选".concat(e.maximalOptions,"个哦")}),void(t.isElect=!t.isElect);1==t.quantity?o["default"].set(t,"quantity",0):o["default"].set(t,"quantity",1),this.numconfigShow=!0}this.current=t.dishName,this.food=t,this.Selected()},addFood:function(){if(this.validator()){if(this.selectFoods.quantity){var t=this.selectFoods.quantity+1;o["default"].set(this.selectFoods,"quantity",t)}else o["default"].set(this.selectFoods,"quantity",1);o["default"].set(this.selectFoods,"count",1);var e=[];this.selectFoods.optionCategoryList&&this.selectFoods.optionCategoryList.forEach(function(t){t.optionList.forEach(function(t,i,o){t.isElect&&e.push({id:o[i].id,optionName:o[i].optionName,price:o[i].price,required:o[i].required,categoryId:o[i].categoryId})})}),this.selectFoods.itemPrice=this.selectFoods.itemPrice?this.selectFoods.itemPrice:0;var i={dishKind:this.selectFoods.dishKind,dishID:this.selectFoods.dishID,dishName:this.selectFoods.dishName,price:this.totalPrice+this.selectFoods.itemPrice,marketPrice:this.totalPrice+this.selectFoods.itemPrice,marketPriceCost:this.totalPrice+this.selectFoods.itemPrice,cost:this.selectFoods.memberPrice>0&&"true"==window.localStorage.getItem("userIsMember")?this.totalMemberPrice:this.totalPrice+this.selectFoods.itemPrice,waimaiPrice:this.selectFoods.waimaiPrice,quantity:this.selectFoods.count,comment:this.selectFoods.comment,gift:this.selectFoods.gift,subItemList:[],marketList:[],unit:this.selectFoods.unit,optionList:e,imageName:this.selectFoods.imageName,seq:0};this.$emit("addCustom",i,this.target),this.hide()}},defaultShow:function(){this.Selected()},Selected:function(){var t="";this.selectFoods.optionCategoryList&&this.selectFoods.optionCategoryList.forEach(function(e){var i=0;e.optionList.forEach(function(s,a,n){1==e.maximalOptions&&(s.isElect||(i++,i==n.length&&(n[0].isElect=!0,o["default"].set(n[0],"quantity",1)))),s.isElect&&(t+=" "+n[a].optionName+" /")})});var e=0;this.selectFoods.optionCategoryList&&this.selectFoods.optionCategoryList.forEach(function(t){t.optionList.forEach(function(t,i,o){t.isElect&&(e+=(t.quantity>0?t.quantity:0)*(t.price>0?t.price:0))})}),this.totalPrice=parseFloat((this.selectFoods.price+e).toFixed(2)),this.totalMemberPrice=parseFloat((this.selectFoods.memberPrice+e).toFixed(2)),this.selectedCustom=t.slice(0,t.length-1),this.$forceUpdate()},validator:function(){var t=!0;return this.selectFoods.optionCategoryList.forEach(function(e){var i=0;e.optionList.forEach(function(t){i+=t.quantity?t.quantity:0}),e.minimalOptions>i&&(t=!1,Object(at["Toast"])({className:"toasts",message:"".concat(e.optionCategoryName,",此项还未选完哦~")}))}),!!t}}},Jt=Ht,Gt=(i("1292"),Object(m["a"])(Jt,Kt,Wt,!1,null,"6f5dd9de",null));Gt.options.__file="foodcustom.vue";var Yt=Gt.exports,Xt={props:{selectFoods:{},target:{}},components:{cartcontrol:Ct,foodcustom:Yt},data:function(){return{showMemberPrice:window.localStorage.getItem("showMemberPrice"),courese:!0,showFlag:!1,isElect:!1,food:{},numconfigShow:!1,current:"",newFood:[],selectConfig:[],foodItems:{},optionList:[],index:"",transmission:"",storageItems:"",storageMaxitemCount:"",maxitemCount:0}},computed:{totalPrice:function(){var t=0;return this.optionList.forEach(function(e){t+=e.quantity*(e.price>0?e.price:0)}),parseFloat(t.toFixed(2))}},methods:{show:function(){var t=this;this.showFlag=!0,this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.config,{click:!0}),t.init()})},hide:function(){this.showFlag=!1,this.$forceUpdate()},init:function(){this.index="",this.storageItems="",this.optionList.splice(0,this.optionList.length),this.selectFoods.packageItems.forEach(function(t){t.options.forEach(function(t){t.isElect=!1,t.quantity=0})})},_elect:function(t,e,i){this.isElectToggle(t,e,i,"")},addFood:function(){if(this.validator()){this.selectFoods.quantity?this.selectFoods.quantity++:o["default"].set(this.selectFoods,"quantity",1),o["default"].set(this.selectFoods,"count",1);var t={dishKind:this.selectFoods.dishKind,dishID:this.selectFoods.dishID,dishName:this.selectFoods.dishName,price:this.selectFoods.price+this.totalPrice,marketPrice:this.selectFoods.price+this.totalPrice,marketPriceCost:this.selectFoods.price+this.totalPrice,cost:this.selectFoods.memberPrice>0&&"true"==window.localStorage.getItem("userIsMember")?this.selectFoods.memberPrice+this.totalPrice:this.selectFoods.price+this.totalPrice,waimaiPrice:this.selectFoods.waimaiPrice,quantity:this.selectFoods.count,comment:this.selectFoods.comment,gift:this.selectFoods.gift,subItemList:this.optionList,marketList:[],optionList:[],seq:0};this.$emit("addCustom",t,this.target),this.hide()}},addFoodList:function(t){var e={dishID:t.dishID,dishName:t.dishName,price:t.price,cost:t.memberPrice>0&&"true"==window.localStorage.getItem("userIsMember")?t.memberPrice:t.price,quantity:1,waimaiPrice:t.waimaiPrice,marketExtraPrice:null,comment:t.comment,packageItems:"",optionList:!1,imageName:t.imageName};this.addPlural(e)},addOdd:function(t){var e=this;this.storageItems&&(1==this.storageItems.itemCount?this.storageItems.options.forEach(function(t,i,o){i==e.index?(t.quantity=1,t.isElect=!0):(t.quantity=0,t.isElect=!1,e.DeletFood(t))}):this.transmission&&(this.transmission.isElect=!0));var i=!0;this.optionList.forEach(function(e){e.dishID==t.dishID&&(i=!1)}),i&&(t.quantity=1,t.isElect=!0,this.optionList.push(t)),this.isMax(t)},addPlural:function(t){this.food=t,this.Selected();var e=!1,i=!1,o=!1,s=!1,a=!1,n=0,r=0;if(this.optionList.length>0){e=!1;for(var c=0;c<this.optionList.length;c++)if(this.optionList[c].dishID==t.dishID&&(console.log("dishID相同"),n=c,i=!0,t.optionList&&(this.optionList[c].length>0||t.optionList.length>0)&&(console.log("定制项长度大于零"),o=!0,c,this.optionList[c].optionList.length==t.optionList.length))){console.log("定制项长度相同"),s=!0,c;for(var d=0;d<t.optionList.length;d++)t.optionList[d].id==this.optionList[c].optionList[d].id&&(a=!0,r=c,console.log("id相同"))}}else e=!0;if(e)this.optionList.push(t);else{if(a)return void(this.optionList[r].quantity=this.optionList[r].quantity+1);if(s)return t.seq=this.optionList.length,void this.optionList.push(t);if(o)return t.seq=this.optionList.length,void this.optionList.push(t);if(i)return void(this.optionList[n].quantity=this.optionList[n].quantity+1);this.optionList.push(t)}},isElectToggle:function(t,e,i){var o=this;if(this.index=i,this.isMax(t,e,i),0!=this.isMax(t,e,i)){if(t.optionCategoryList){if(t.optionCategoryList.length>0)return t.isElect?(this.transmission="",t.isElect=!1,t.quantity=0,this.DeletFood(t)):(this.$refs.foodcustom.show(),this.transmission=t,this.storageItems=e,this.foodItems=t),!1}else this.storageItems="";if(1==e.itemCount)e.options.forEach(function(t,e,s){if(e!=i)return t.quantity=0,t.isElect=!1,o.DeletFood(t),!1;t.quantity=1,t.isElect=!0});else{if(this.transmission="",t.isElect)return t.isElect=!1,t.quantity=0,this.DeletFood(t),!1;t.isElect=!0,t.quantity=1,this.$forceUpdate()}this.addOdd(t)}},isMax:function(t,e,i){var s=this;if(e||this.selectFoods.packageItems.forEach(function(i){i.itemCount>1&&i.options.forEach(function(o){o.dishID==t.dishID&&(e=i)})}),e&&(this.maxitemCount=0,e.options.forEach(function(t){t.isElect&&(s.maxitemCount+=t.quantity)}),e.options.forEach(function(t){o["default"].set(t,"maxitemCount",s.maxitemCount)}),!t.isElect&&1!==e.itemCount&&this.maxitemCount==e.itemCount))return this.numconfigShow=!1,Object(at["Toast"])({className:"toasts",message:"这类最多只能选".concat(e.itemCount,"个哦")}),!1},addFoodNum:function(t){var e;this.isMax(t),this.optionList.forEach(function(i,o,s){i.dishID==t.dishID&&(e=o)}),void 0!==e&&(this.optionList[e].quantity>0&&(this.optionList[e].quantity++,t.isElect=!0),t.optionCategoryList&&t.optionCategoryList.length>0&&t.quantity++),this.$forceUpdate(),this.isMax(t)},DeletFood:function(t){var e,i=this;this.isMax(t),this.optionList.forEach(function(i,o,s){i.dishID==t.dishID&&(e=o)}),void 0!==e&&(console.log(e),this.optionList[e].quantity>0&&(this.optionList[e].quantity--,t.quantity=this.optionList[e].quantity)),this.optionList.forEach(function(t,e,o){!t.quantity>0&&(console.log("已删除菜品",t.dishName),i.optionList.splice(e,1))}),this.selectFoods.packageItems.forEach(function(t){t.options.forEach(function(t,e,i){!t.quantity>0&&(t.isElect=!1)})}),this.$forceUpdate(),this.isMax(t)},validator:function(){var t=!0;return this.selectFoods.packageItems.forEach(function(e){if(e.itemCount>0){var i=0;e.options.forEach(function(t){i+=t.quantity}),e.itemCount>i&&(t=!1,Object(at["Toast"])({className:"toasts",message:"".concat(e.userdefinedName?e.userdefinedName:e.itemName,",此项还未选完哦~")}))}}),!!t}}},Qt=Xt,Zt=(i("5242"),Object(m["a"])(Qt,Rt,zt,!1,null,"57d5a4cd",null));Zt.options.__file="setCourese.vue";var Vt=Zt.exports,te=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"move"}},[t.showFlag?o("div",{staticClass:"recommended"},[o("div",{staticClass:"back",on:{click:t.hide}},[o("i",{staticClass:"iconfont icon-close2"})]),o("h2",{staticClass:"title"},[t._v(t._s(t.reTxt))]),o("div",{ref:"food",staticClass:"foodbox"},[o("div",[t.recommandList.length>0?o("div",{staticClass:"recommand"},[o("ul",t._l(t.recommandList,function(e,s){return o("li",{key:s},[e.imageName?o("img",{attrs:{src:e.imageName,alt:""}}):o("img",{attrs:{src:i("e0e4")}}),o("div",{staticClass:"recoInfo"},[o("div",{staticClass:"dishName"},[t._v(t._s(e.dishName))]),o("div",{staticClass:"sales"},[o("span",[t._v("销量"+t._s(e.salesCount))]),t._v(" \n                  "),e.memberPrice?o("span",[t._v("会员价￥"+t._s(e.memberPrice))]):t._e()]),o("div",{staticClass:"price"},[o("span",[t._v("￥"+t._s(e.price))])]),o("cartcontrol",{attrs:{food:e},on:{addFood:function(e){t.addFoodList(arguments)},DeletFood:t.DeletFood}})],1)])}))]):t._e()])])]):t._e()])},ee=[],ie={props:{food:{type:Object},data:{}},data:function(){return{showFlag:!1,foodItems:{},optionList:[],recommandList:[],reTxt:""}},methods:{show:function(){var t=this,e={appId:window.localStorage.getItem("appid"),brandId:window.localStorage.getItem("brandid"),storeId:window.localStorage.getItem("storeid"),sourcetype:2,dishtype:2};r.a.post("../../api/terminal/getRecommendedDish",d.a.stringify(e)).then(function(e){t.recommandList=e.data.data.dishData}),this.showFlag=!0,this.$nextTick(function(){t.init(),t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.food,{click:!0})})},hide:function(){this.showFlag=!1},init:function(){this.reTxt=window.localStorage.getItem("recommend")},addFoodList:function(t){var e=Object(Mt["a"])(t,2),i=e[0],o=e[1];this.$emit("addFood",i,o)},DeletFood:function(t){this.$emit("DeletFood",t)}},components:{cartcontrol:Ct}},oe=ie,se=(i("f371"),Object(m["a"])(oe,te,ee,!1,null,"43997060",null));se.options.__file="recommended.vue";var ae=se.exports,ne=i("54a1"),re={getUrlKey:function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.href)||[,""])[1].replace(/\+/g,"%20"))||null}},ce={data:function(){return{title:window.localStorage.getItem("welcomeSname"),showMemberPrice:window.localStorage.getItem("showMemberPrice"),data:[],goods:[],listHeight:[],scrollY:0,selectedFood:{},banner:["https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1542347342995&di=0e7e8136341cca94b648935109c27534&imgtype=0&src=http%3A%2F%2Fimgsrc.baidu.com%2Fimgad%2Fpic%2Fitem%2Fdcc451da81cb39dbb8099371db160924aa1830cf.jpg","https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1542347342994&di=00d57184cbd0a0433cb766dce0ddf8a5&imgtype=0&src=http%3A%2F%2Fimgsrc.baidu.com%2Fimgad%2Fpic%2Fitem%2Ff603918fa0ec08fae0b1528f52ee3d6d55fbda61.jpg","https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1542347342994&di=4ca31c6b9bdd339ef93b4d18d859910e&imgtype=0&src=http%3A%2F%2Fimgsrc.baidu.com%2Fimgad%2Fpic%2Fitem%2F4a36acaf2edda3cc382ca40c0ae93901203f92d5.jpg","https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1542347342993&di=f07b045c587fcda79be6101b8e4d58aa&imgtype=0&src=http%3A%2F%2Fimgsrc.baidu.com%2Fimgad%2Fpic%2Fitem%2F4afbfbedab64034feac8af3ca4c379310a551d86.jpg"],animate:!0,foodItems:{},foodList:[],optionList:[],target:"",drop:!0,loading:!1}},mounted:function(){var t=this;window.localStorage.getItem("allState");var e={appid:re.getUrlKey("appid"),brandid:re.getUrlKey("brandid"),storeid:re.getUrlKey("storeid"),dishtype:re.getUrlKey("dishtype")};e.phone=window.sessionStorage.getItem("phoneNum"),this.loading=!0,r.a.post("api/wx/getDish",d.a.stringify(e)).then(function(e){t.loading=!1,1057==e.data.result?alert("该时段无菜品出售"):(window.localStorage.setItem("userIsMember",e.data.content.member),t.data=e.data.content.dish,t.$nextTick(function(){t._initScroll(),t._calculateHeight()}))})},computed:{currentIndex:function(){for(var t=0;t<this.listHeight.length;t++){var e=this.listHeight[t],i=this.listHeight[t+1];if(!i||this.scrollY>=e&&this.scrollY<i)return this._followScroll(t),t}return 0},selectFoods:function(){var t=[];return t=this.optionList,t}},watch:{data:{handler:function(t,e){for(var i=0;i<t.length;i++)if(t[i].dishData){for(var o=0,s=0;s<t[i].dishData.length;s++)o+=t[i].dishData[s].quantity?t[i].dishData[s].quantity:0;t[i].count=o}window.localStorage.setItem("allState",JSON.stringify(this.optionList)),this.$forceUpdate()},deep:!0}},methods:{selectMenu:function(t,e){if(e._constructed){var i=this.$refs.foodList,o=i[t];this.foodsScroll.scrollToElement(o,300),this.foodsScroll.refresh(),this.meunScroll.refresh()}},selectFood:function(t,e){e._constructed&&(this.selectedFood=t,this.$refs.food.show())},addFood:function(t){this._drop(t)},_drop:function(t){},_initScroll:function(){var t=this;this.meunScroll=new rt["a"](this.$refs.menuWrapper,{click:!0,probeType:3}),this.meunScroll.on("scroll",function(e){t._bannerHS(t.meunScroll)}),this.foodsScroll=new rt["a"](this.$refs.foodsWrapper,{click:!0,probeType:3}),this.foodsScroll.on("scroll",function(e){e.y<=0&&(t.scrollY=Math.abs(Math.round(e.y))),t._bannerHS(t.foodsScroll)})},_bannerHS:function(t){var e=this;t.y>0?this.animate&&(st()(this.$refs.banner).stop().animate({top:"0"},500),st()(this.$refs.wrapper).stop().animate({top:st()(this.$refs.banner).height()},500,function(){e.animate=!0,t.refresh()}),this.animate=!1):t.y<-10&&this.animate&&(st()(this.$refs.banner).stop().animate({top:"-"+st()(this.$refs.banner).height()},500),st()(this.$refs.wrapper).stop().animate({top:"0"},500,function(){e.animate=!0,t.refresh()}),this.animate=!1)},_calculateHeight:function(){var t=this.$refs.foodList,e=0;this.listHeight.push(e);for(var i=0;i<t.length;i++){var o=t[i];e+=o.clientHeight,this.listHeight.push(e)}},_followScroll:function(t){var e=this.$refs.menuList,i=e[t];this.meunScroll.scrollToElement(i,300,0,-100)},addFoodList:function(t){var e=this;if(t.length>0){var i=t[0],s=t[1];this.target=s}else i=t;if(this.foodItems=i,void 0!==i.packageItems&&1==i.isPackage)return this.$refs.setCourese.show(),!1;if(i.optionCategoryList.length>0)return this.$refs.foodcustom.show(),!1;if(this.$nextTick(function(){e.$refs.shopcart.drop(s)}),i.quantity){var a=i.quantity+1;o["default"].set(i,"quantity",a)}else o["default"].set(i,"quantity",1);var n={dishKind:i.dishKind,imageName:i.imageName,dishID:i.dishID,dishName:i.dishName,price:i.price,waimaiPrice:i.waimaiPrice,marketPrice:i.price,marketPriceCost:i.price,cost:i.memberPrice>0&&"true"==window.localStorage.getItem("userIsMember")?i.memberPrice:i.price,quantity:i.quantity,comment:i.comment,gift:i.gift,dishUnit:i.dishUnit,subItemList:[],marketList:[],optionList:[],seq:0};this.addCustom(n)},addCustom:function(t){var e=this;if(t.length>0){var i=t[0],o=t[1];this.$nextTick(function(){e.$refs.shopcart.drop(o)})}else i=t;i.add=!0;var s,a,n,r,c,d,l,u=!1;if(this.optionList.length>0){s=!1;for(var h=0;h<this.optionList.length;h++)if(this.optionList[h].dishID==i.dishID)if(console.log("dishID相同"),d=h,a=!0,this.optionList[h].subItemList.length>0&&i.subItemList.length>0)u=!0;else if(console.log("定制项长度不相同"),n=!0,h,this.optionList[h].optionList.length==i.optionList.length){console.log("定制项长度相同"),r=!0,h;for(var p=0;p<i.optionList.length;p++)i.optionList[p].id==this.optionList[h].optionList[p].id&&(c=!0,l=h,console.log("id相同"))}}else s=!0;if(s)this.optionList.push(i);else{if(u)return i.seq=this.optionList.length,void this.optionList.push(i);if(c)return void(this.optionList[l].quantity=this.optionList[l].quantity+1);if(r)return void(this.optionList[d].quantity=this.optionList[d].quantity+1);if(n)return i.seq=this.optionList.length,void this.optionList.push(i);if(a)return void(this.optionList[d].quantity=this.optionList[d].quantity+1);this.optionList.push(i)}},DeletFood:function(t){var e,i=this;if(this.optionList.forEach(function(i,o,s){i.dishID==t.dishID&&(e=o)}),this.data.forEach(function(e){e.dishData.forEach(function(e,i){if(e.dishID==t.dishID){var s=e.quantity-1;o["default"].set(e,"quantity",s)}})}),this.optionList[e].quantity>0){var s=this.optionList[e].quantity-1;o["default"].set(this.optionList[e],"quantity",s)}this.optionList.forEach(function(t,e,o){!t.quantity>0&&i.optionList.splice(e,1)})},recommendedGo:function(t){this.$refs.recommended.show()}},components:{loading:ne["default"],navTop:g,Slider:gt,cartcontrol:Ct,shopcart:Et,food:Ut,setCourese:Vt,foodcustom:Yt,recommended:ae}},de=ce,le=(i("5c52"),Object(m["a"])(de,et,it,!1,null,"2db14e9e",null));le.options.__file="goods.vue";var ue=le.exports,he=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"move"}},[o("div",{ref:"payPage",staticClass:"payPage"},[o("navTop",{attrs:{title:t.title}}),o("div",{ref:"paySrcoll",staticClass:"paySrcoll"},[o("div",[o("div",{staticClass:"payBox mode"},[o("div",{staticClass:"left"},[t._v("就餐方式")]),o("div",{staticClass:"right"},[o("mt-radio",{attrs:{options:t.modeConfig},model:{value:t.switchvue,callback:function(e){t.switchvue=e},expression:"switchvue"}})],1)]),"外卖"==t.switchvue?o("div",{staticClass:"payBox",on:{click:t.addressList}},[o("div",{staticClass:"left"},[t._v("收货地址")]),o("div",{staticClass:"right"},[t.get_addressInfo.address?o("span",[t._v(t._s(t.get_addressInfo.address))]):o("span",[t._v("选择收货地址")]),o("em",{staticClass:"iconfont icon-jiantou"})])]):t._e(),o("div",{staticClass:"payBox dishList"},[o("ul",[t._l(t.selectFoods,function(e,s){return o("li",{key:s},[o("span",{staticClass:"imageName"},[e.imageName?o("img",{attrs:{src:e.imageName,alt:""}}):o("img",{attrs:{src:i("e0e4"),alt:""}})]),o("span",{staticClass:"dishName",class:{lhcent:e.optionList.length>0||e.subItemList.length>0}},[o("span",[t._v(t._s(e.dishName))]),e.optionList.length>0?o("p",t._l(e.optionList,function(e,i){return o("em",{key:i},[t._v(t._s(e.optionName)+" /")])})):e.subItemList.length>0?o("p",t._l(e.subItemList,function(e,i){return o("em",{key:i},[t._v(t._s(e.dishName)+t._s(e.quantity>1?"x"+e.quantity+e.unit:"")+" /")])})):t._e()]),o("span",{staticClass:"dishUnit"},[t._v("x"+t._s(e.quantity+(e.dishUnit?e.dishUnit:"")))]),o("span",{staticClass:"price"},[t._v("￥"+t._s(e.price))])])}),"堂食"!==t.switchvue?o("li",[o("span",[t._v("外带费")]),o("span",{staticStyle:{flex:"0 0 87%","text-align":"right"}},[t._v("￥"+t._s(t.setState.takeoutFee))])]):t._e()],2),o("h2",[o("div",{staticClass:"left"},[t._v("小计")]),o("div",{staticClass:"right"},[o("span",[t._v("￥"+t._s("堂食"!==t.switchvue?t.setState.cost+t.setState.takeoutFee:t.setState.cost))]),t.setState.discount>0?o("del",[t._v("￥"+t._s(t.totalPrice))]):t._e()])])]),t.setState.accountMember?o("div",{staticClass:"payBox rebate"},[o("ol",[o("li",{staticClass:"denoCoupon"},[o("div",{staticClass:"left"},[t._v("优惠券")]),o("div",{staticClass:"right",on:{click:t.couponShow}},[t._v("\n                "+t._s(t.setState.denoCoupon.word)+"\n                "),o("em",{staticClass:"iconfont icon-jiantou"})])]),o("li",[o("div",{staticClass:"left"},[t._v("积分余额"+t._s(t.setState.credit)+",使用"+t._s(t.creditNum))]),o("div",{staticClass:"right"},[o("mt-switch",{model:{value:t.credit,callback:function(e){t.credit=e},expression:"credit"}})],1)]),o("li",[o("div",{staticClass:"left"},[t._v("储值余额￥"+t._s(t.setState.balance)+",使用"+t._s(t.balanceNum))]),o("div",{staticClass:"right"},[o("mt-switch",{on:{change:t.changeBalance},model:{value:t.balance,callback:function(e){t.balance=e},expression:"balance"}})],1)])])]):t._e(),o("div",{staticClass:"payBox remarks"},[o("div",{staticClass:"left"},[t._v("订单备注")]),o("div",{staticClass:"right"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bak,expression:"bak"}],attrs:{placeholder:"口味、偏好等其他需求"},domProps:{value:t.bak},on:{blur:t.blurFun,input:function(e){e.target.composing||(t.bak=e.target.value)}}})])])])]),o("div",{staticClass:"paybtn"},[o("div",{staticClass:"left"},[o("span",[t._v("￥"+t._s(t.onSetComputer))]),t.setState.discount>0?o("span",[t._v("已优惠￥"+t._s(t.setState.discount))]):t._e()]),o("div",{staticClass:"right"},[o("button",{staticClass:"pay",on:{click:t.onsubmit}},[t._v(t._s(t.payDesc))])])]),o("coupon",{ref:"coupon",attrs:{Order:t.Order.accountMember},on:{couponData:t.getcouponData}}),o("loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],1)])},pe=[],me=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showFlag?i("div",{staticClass:"coupon"},[i("div",{staticClass:"couponPop"},[i("h2",[t._v(t._s(t.Order.gradeName))]),i("ul",t._l(t.Order.coupons,function(e,o){return i("li",{key:o,class:e.isElect?"active":"",on:{click:function(i){t.toggle(e)}}},[i("div",{staticClass:"title"},[t._v(t._s(e.title))]),i("div",{staticClass:"time"},[t._v("有效期至 "+t._s(e.failure_time))]),i("div",{staticClass:"checked icon-duigou iconfont"})])}))]),i("div",{staticClass:"list-mask",on:{click:t.hide}})]):t._e()}),fe=[],ge={props:{Order:{}},data:function(){return{showFlag:!1,checked:!0,data:{}}},methods:{show:function(){this.showFlag=!0},hide:function(){this.showFlag=!1},toggle:function(t){var e=this;if(t.isElect)o["default"].set(t,"isElect",!1),this.data={},this.$emit("couponData",this.data),this.$forceUpdate();else{for(var i=0;i<this.Order.coupons.length;i++)o["default"].set(this.Order.coupons[i],"isElect",!1);o["default"].set(t,"isElect",!0),this.data={title:t.title,deno:t.deno,coupon_ids:t.coupon_ids[0],products:t.products[0]},this.$forceUpdate(),this.$emit("couponData",this.data),setTimeout(function(){e.hide()},300)}}}},ve=ge,we=(i("fd78"),Object(m["a"])(ve,me,fe,!1,null,"68c20482",null));we.options.__file="coupon.vue";var _e=we.exports,be={props:{},data:function(){return{modeConfig:["堂食","外带"],screenHeight:document.body.clientHeight,loading:!1,selectFoods:{},title:window.localStorage.getItem("welcomeSname"),bak:"",couponCodeRef:"",payFlag:0,showFlag:!1,couponData:{},setState:{denoCoupon:{word:""}},switchvue:"堂食",credit:!1,creditNum:0,balance:!1,balanceNum:0,Order:{},comTotalPrice:0,password:"",browserName:window.localStorage.getItem("browserName"),source:1==this.browserName?"支付宝":"微信",openid:window.sessionStorage.getItem("openid")?window.sessionStorage.getItem("openid"):"oNFKzv5kO0nzu4c_iza-L9yMLjvc"}},computed:Object(St["a"])({},Object(xt["b"])(["get_selectFoods","get_totalPrice","get_addressInfo"]),{payDesc:function(){return 0==this.payFlag?"结算中":1==this.payFlag?"确定支付":2==this.payFlag?"订单错误":void 0},couponCode:function(){return this.couponCodeRef.length>0},onSetComputer:function(){return this.comTotalPrice=this.setState.cost-(this.couponData.deno?this.couponData.deno:0),"外带"!=this.switchvue&&"外卖"!=this.switchvue||(this.comTotalPrice+=parseInt(this.setState.takeoutFee)),this.credit?(this.setState.credit-this.comTotalPrice<=0?this.creditNum=this.setState.credit:this.creditNum=parseInt(this.comTotalPrice),this.comTotalPrice-=this.creditNum):this.creditNum=0,this.balance?(this.setState.balance-this.comTotalPrice<=0?this.balanceNum=this.setState.balance:this.balanceNum=this.comTotalPrice,this.comTotalPrice-=this.balanceNum):this.balanceNum=0,this.comTotalPrice=this.comTotalPrice&&this.comTotalPrice>0?parseInt(100*this.comTotalPrice.toFixed(2))/100:0,this.setState.realcoat=this.comTotalPrice,this.comTotalPrice}}),watch:{switchvue:function(t){var e=this;if("外卖"==t){this.totalPrice+=this.setState.takeoutFee;var i=!0,o={appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),customerid:window.sessionStorage.getItem("openid")};r.a.post("../../wx/getDeliverCustomerInfoByCustomerid",d.a.stringify(o)).then(function(t){if(0==t.data.result){var o=t.data.content,s=window.localStorage.getItem("point").split(",");AMap&&o.forEach(function(t){if(t.xy=JSON.parse(t.xy),t.xy instanceof Array){var o=AMap.GeometryUtil.distance(s,t.xy);console.log(t.defaultCheck),o<3e3&&1==t.defaultCheck&&(e.set_addressInfo(t),i=!1),i&&e.set_addressInfo("")}})}})}else"外带"==t?this.totalPrice+=this.setState.takeoutFee:this.totalPrice=this.get_totalPrice}},activated:function(){"true"==window.localStorage.getItem("saleOut")&&(this.modeConfig=["堂食","外带","外卖"]),this.selectFoods=this.get_selectFoods,this.totalPrice=this.get_totalPrice,this.show(),!this.selectFoods.length>0&&this.$router.push({path:"/goods"})},methods:Object(St["a"])({},Object(xt["c"])(["set_addressInfo"]),{show:function(){var t=this;this.showFlag=!0,this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.paySrcoll,{click:!0}),t.newFastFoodOrder()})},hide:function(){this.showFlag=!1},couponShow:function(){this.Order.accountMember.coupons.length>0&&this.$refs.coupon.show()},changeBalance:function(){var t=this;this.balance&&at["MessageBox"].prompt("请输入密码").then(function(e){var i=e.value;e.action;if(i.length>0)return t.password=i,void t.$nextTick(function(){t.balance=!0})}).catch(function(){t.balance=!1}),this.$nextTick(function(){t.balance=!1})},getcouponData:function(t){this.couponData=t,this.setState.denoCoupon.word=t.title?t.title:this.Order.accountMember.coupons.length+"张可用代金券"},newFastFoodOrder:function(){var t=this,e=this.selectFoods,i={total:this.totalPrice,member:window.localStorage.getItem("userIsMember"),source:this.source,discount:0,createdBy:2,customerAmount:1,subtraction:0,orderType:0,paymentStatus:"NOT_PAYED",itemList:e},o=(navigator.userAgent.toLowerCase(),this.$route.query,{appid:re.getUrlKey("appid"),openid:this.openid,storeid:re.getUrlKey("storeid"),tableid:re.getUrlKey("table"),orderdata:JSON.stringify(i),phoneModel:navigator.userAgent,phone:window.sessionStorage.getItem("phoneNum")?window.sessionStorage.getItem("phoneNum"):""});this.loading=!0,r.a.post("../../wx/newFastFoodOrder",d.a.stringify(o)).then(function(e){t.loading=!1;var i=e.data;if(0==i.result)t.payFlag=1,t.Order=e.data.content,t.setState={isloading:!1,paymented:i.content.paymented,id:i.content.id,total:i.content.total.toFixed(2),accountMember:i.content.accountMember,enterprise:i.content.enterprise,discount:i.content.marketDetailStr.toFixed(2),cost:i.content.cost,realcoat:i.content.cost,takeoutFee:i.content.takeoutFee,credit:i.content.accountMember?i.content.accountMember.credit:2,balance:i.content.accountMember?parseFloat((parseInt(i.content.accountMember.balance)/100).toFixed(2)):2,denoCoupon:{word:i.content.accountMember?"你有"+i.content.accountMember.coupons.length+"张可用代金券":"暂无可用代金券",use:!1,cost:0,id:""}};else if(1123==i.result){for(var o="",s=i.content.length-1;s>=0;s--)o+=i.content[s].dishName+",";Object(at["Toast"])({className:"toasts",message:o+i.errmsg}),t.payFlag=2}else if(1110==i.result){var a="";for(s=i.content.length-1;s>=0;s--)a+=i.content[s]+",";Object(at["Toast"])({className:"toasts",message:a+i.errmsg}),t.payFlag=2}else Object(at["Toast"])({className:"toasts",message:str+i.errmsg}),t.payFlag=2})},onsubmit:function(){var t=this;if(1!==this.payFlag)return!1;if("堂食"==this.switchvue)var e=0;else if("外带"==this.switchvue)e=1;else if("外卖"==this.switchvue){if(!this.get_addressInfo.id)return Object(at["Toast"])({className:"toasts",message:"请选择收货地址"}),!1;e=2}this.$route.query;var i="外带"==this.switchvue||"外卖"==this.switchvue?parseInt((100*(this.setState.cost+this.setState.takeoutFee)).toFixed(0)):parseInt((100*this.setState.cost).toFixed(0));console.log("外带"==this.switchvue||"外卖"==this.switchvue);var o={appid:re.getUrlKey("appid"),storeid:re.getUrlKey("storeid"),openid:this.openid,clientip:"192.169.1.106",orderid:this.Order.id,orderType:e,consumeAmount:i,paymentAmount:parseInt((100*this.onSetComputer).toFixed(0)),totalAmount:parseInt((100*this.totalPrice).toFixed(0)),comment:this.bak,bizId:(new Date).getTime()},s=this.Order.accountMember;if(window.localStorage.getItem("subscribe")&&(o.subscribe=window.localStorage.getItem("subscribe")),null!=s&&(o.uid=s.uid,o.memberid=s.uid,o.memberName=s.name,o.memberPhoneNumber=s.phone,o.cno=s.uno,o.denoCouponId=this.couponData.coupon_ids?this.couponData.coupon_ids:"",o.products=this.couponData.products,o.denoCouponCash=this.couponData.cost,o.credit=this.creditNum,o.balance=parseInt((100*this.balanceNum).toFixed(0)),o.password=this.password,o.gradeName=s.gradeName),(e=2)&&(o.deliverCustomerInfoid=this.get_addressInfo.id),this.loading=!0,2==this.browserName)r.a.post("../../wx/fastFoodPayOrder",d.a.stringify(o)).then(function(e){t.loading=!1;var i=e.data,o=t.Order.id,s=t;0==i.result?t.setState.paymented&&parseFloat(t.setState.realcoat)>0?w.a.chooseWXPay({appId:i.content.appId,timestamp:i.content.timeStamp,nonceStr:i.content.nonceStr,package:i.content.package,signType:i.content.signType,paySign:i.content.paySign,success:function(t){if(sessionStorage.setItem("orderType",1),null!==i.content.templateId){var e=window.location.href;e=e.replace("/payPage","/PaySuccess?orderid="+o),console.log(e),e=encodeURIComponent(e.replace("http://sz.canxingjian.com","http://www.smarant.com")),console.log(e);var a=i.content.templateId;window.location.href="https://mp.weixin.qq.com/mp/subscribemsg?action=get_confirm&appid="+i.content.appId+"&scene=887&template_id="+a+"&redirect_url="+e+"&reserved="+o+"#wechat_redirect"}else s.$router.push({path:"/PaySuccess",query:{orderid:o}})},cancel:function(t){console.log("取消支付"),s.newFastFoodOrder()},fail:function(t){console.log("支付失败"),s.newFastFoodOrder()}}):s.$router.push({path:"/PaySuccess",query:{orderid:o}}):-8==i.result?t.setState.paymented&&parseFloat(t.setState.realcoat)>0?WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:i.content.appId,timeStamp:i.content.timeStamp,nonceStr:i.content.nonceStr,package:i.content.package,signType:i.content.signType,paySign:i.content.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg?(sessionStorage.setItem("orderType",1),s.$router.push({path:"/PaySuccess",query:o})):(t.err_msg,s.newFastFoodOrder())}):t.$router.push({path:"/PaySuccess",query:{orderid:o}}):3056==i.result||3055==i.result||1002==i.result?(alert(i.errmsg),s.newFastFoodOrder(),s.password=""):alert(i.errmsg)});else if(1==this.browserName){var a=this.Order.id;o.userid=this.openid,o.type=1,r.a.post("../../alipay/fastFoodPayOrder",d.a.stringify(o)).then(function(e){t.loading=!1;var i=t,o=e.data;0==o.result&&(t.setState.paymented&&parseFloat(t.setState.realcoat)>0?(document.body.innerHTML+=o.content,document.forms[0].submit()):t.$router.push({path:"/PaySuccess",query:{orderid:a}})),-8==o.result&&(t.setState.paymented&&parseFloat(t.setState.realcoat)>0?AlipayJSBridge.call("tradePay",{tradeNO:o.content.tradeNO},function(e){"9000"==e.resultCode&&t.$router.push({path:"/PaySuccess",query:a}),"4000"!=e.resultCode&&"6001"!=e.resultCode&&"6002"!=e.resultCode||i.onCancelPay()}):t.$router.push({path:"/PaySuccess",query:{orderid:a}}))})}},blurFun:function(){document.body.scrollTop=0},addressList:function(){this.$router.push({path:"/addressList"})},getEnterprisePlan:function(){var t=this;this.couponCode?r.a.post("../../public/waimai/meituan/shop/validationSetout",d.a.stringify({appId:this.$route.query.appid,storeId:this.$route.query.storeid,brandId:this.$route.query.brandid,couponCode:this.couponCodeRef})).then(function(e){var i=e.data;if(!i.data)return Object(at["Toast"])({className:"toasts",message:"没有该优惠码，请重新输入"}),t.couponCodeRef="",!1;var o=i.data.enterpriseMarket,s=0;if(!(t.setState.cost>=o.minConsumption))return Object(at["Toast"])({className:"toasts",message:"该优惠满"+o.minConsumption+"可用"}),t.couponCodeRef="",!1;if(t.setState.couponCode.word=i.data.promoCode,0==o.marketType){var a=parseFloat(t.setState.cost.toFixed(2))-parseFloat(t.setState.cost.toFixed(2))*o.rate;s=parseFloat(a.toFixed(2))}else s=parseFloat(o.cash);t.setState.couponCode.model=!1,t.setState.couponCode.cost=s}):Object(at["Toast"])({className:"toasts",message:"请先输入优惠码"})}}),components:{loading:ne["default"],SwitchName:at["SwitchName"],coupon:_e,navTop:g}},ye=be,Ce=(i("c56a"),Object(m["a"])(ye,he,pe,!1,null,"1a99c0d8",null));Ce.options.__file="payPage.vue";var Ie=Ce.exports,Fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"paySuccess"},[i("navTop",{attrs:{title:t.title}}),t.iscomplete?i("div",{staticClass:"wait"},[t._v("等待厨房接单，请您稍等，请勿随意更换座位\n    "),t._m(0)]):i("div",{staticClass:"suc"},[i("div",{staticClass:"refuse"},[t._v(t._s(this.showData.model?"取餐号":"餐牌号")+"："+t._s(t.showData.model?t.showData.content.callNumber:t.showData.content.tableNames))]),i("div",{staticClass:"order-info",on:{click:t.orderInfo}},[i("div",{staticClass:"header"},[t._v("订单信息")]),i("p",[t._v("单号："+t._s(t.orderid))]),i("p",[t._v("终端单号: "+t._s(t.showData.content.refOrderId))]),i("p",[t._v("就餐方式: "+t._s(t.showData.content.orderTypeStr))]),i("p",[t._v("下单时间："+t._s(t.showData.content.createdAtStr))]),i("p",[t._v("支付方式："+t._s(t.showData.content.paymentList[0].payName))])]),i("button",{staticClass:"btn",on:{click:t.again}},[t._v("再来一单")])]),t.loading?i("loading"):t._e()],1)},Se=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spinner"},[i("div",{staticClass:"rect1"}),i("div",{staticClass:"rect2"}),i("div",{staticClass:"rect3"}),i("div",{staticClass:"rect4"}),i("div",{staticClass:"rect5"})])}],xe={data:function(){return{loading:!1,title:window.localStorage.getItem("welcomeSname"),iscomplete:!0}},activated:function(){this.init()},methods:{init:function(){this.iscomplete=!0,this.showData={model:!1,content:{callNumber:"",tableNames:"",paymentList:[{payName:""}]}},this.orderid=this.$route.query.orderid,this.onCheckDeliverd()},onCheckDeliverd:function(){var t=this,e={appid:window.localStorage.getItem("appid"),storeid:parseInt(window.localStorage.getItem("storeid")),orderid:this.orderid};this.timer=setInterval(function(){r.a.post("../../wx/checkDeliverd",d.a.stringify(e)).then(function(e){var i=e.data;if(0==i.result){t.shoppingCart;({allprice:0,allNum:0,allCommodity:[],numerObj:{},kindNum:{}}),"2"==i.content.type?(clearInterval(t.timer),window.sessionStorage.setItem("orderid",t.orderid),t.getOrderByOrderID()):"3"==i.content.type&&(clearInterval(t.timer),t.iscomplete=!1,window.sessionStorage.setItem("orderid",t.orderid))}else-1==i.result?(t.iscomplete=!1,window.sessionStorage.setItem("orderid","")):alert(i.errmsg)})},500)},getOrderByOrderID:function(){var t=this;this.loading=!0,r.a.post("../../wx/getOrderByOrderID",d.a.stringify({appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),orderid:this.orderid})).then(function(e){t.loading=!1;var i=e.data;0==i.result?(t.showData.content=i.content,t.getStoreModel()):alert(i.errmsg)})},getStoreModel:function(){var t=this;r.a.post("../../wx/getStoreConfiguration",d.a.stringify({appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),brandid:window.localStorage.getItem("brandid")})).then(function(e){var i=e.data;0==i.result?(t.iscomplete=!1,t.showData.model=i.data.callNumberMode):alert(i.errmsg)})},again:function(){this.$router.push({path:"/goods"})},orderInfo:function(){this.$router.push({path:"/orderInfo",query:{orderid:this.$route.query.orderid}})}},beforeDestroy:function(){clearInterval(this.timer)},components:{loading:ne["default"],navTop:g}},ke=xe,Le=(i("72d0"),Object(m["a"])(ke,Fe,Se,!1,null,"fecf6788",null));Le.options.__file="paySuccess.vue";var Ne=Le.exports,Pe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"orderInfo"},[i("div",{ref:"orderInfo",staticClass:"orderInfoCent"},[i("div",[i("div",{staticClass:"order-info"},[i("div",{staticClass:"header"},[t._v("订单信息")]),i("p",[t._v("单号："+t._s(t.orderid))]),i("p",[t._v("终端单号: "+t._s(t.showData.content.refOrderId))]),i("p",[t._v("就餐方式: "+t._s(t.showData.content.orderTypeStr))]),i("p",[t._v("下单时间："+t._s(t.showData.content.createdAtStr))]),t.showData.content.paymentList[0]?i("p",[t._v("支付方式："+t._s(t.showData.content.paymentList[0].payName))]):t._e()]),i("div",{staticClass:"order-info"},[t._l(t.showData.content.itemList,function(e,o){return i("p",{key:o},[i("span",[t._v(t._s(e.dishName)+"：")]),i("span",[t._v("￥"+t._s(e.price))]),i("span",[t._v("  x"+t._s(e.quantity))])])}),"堂食"!==t.showData.content.orderTypeStr?i("p",[i("span",[t._v("打包费：")]),i("span",[t._v("￥"+t._s(t.showData.content.takeoutFee))])]):t._e(),i("p",[i("span",[t._v("优惠金额：")]),i("span",[t._v("￥"+t._s((t.showData.content.total-t.showData.content.cost).toFixed(2)))])]),i("p",[i("span",[t._v("打包费：")]),i("span",[t._v("￥"+t._s(t.showData.content.takeoutFee))])]),i("p",[i("span",[t._v("总价：")]),i("span",[t._v("￥"+t._s(t.showData.content.total))])]),i("p",[i("span",[t._v("实付：")]),i("span",[t._v("￥"+t._s(t.showData.content.cost))])])],2)])]),i("button",{staticClass:"btn",on:{click:t.again}},[t._v("再来一单")]),t.loading?i("loading"):t._e()],1)},$e=[],De={data:function(){return{loading:!1,title:window.localStorage.getItem("welcomeSname"),iscomplete:!0,orderid:this.$route.query.orderid,showData:{model:!1,content:{callNumber:"",tableNames:"",paymentList:[{payName:""}]}}}},activated:function(){this.init()},methods:{init:function(){var t=this;this.iscomplete=!0,this.showData={model:!1,content:{callNumber:"",tableNames:"",paymentList:[{payName:""}]}},this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.orderInfo,{click:!0})}),this.componentDidMount()},componentDidMount:function(){var t=this;this.loading=!0;var e={appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),orderid:this.orderid};r.a.post("../../wx/getOrderByOrderID",d.a.stringify(e)).then(function(e){var i=e.data;0==i.result?(t.showData.content=i.content,t.getStoreModel()):alert(i.errmsg)})},getStoreModel:function(){var t=this;r.a.post("../../wx/getStoreConfiguration",d.a.stringify({appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),brandid:window.localStorage.getItem("brandid")})).then(function(e){var i=e.data;0==i.result?(t.loading=!1,t.showData.model=i.data.callNumberMode):alert(i.errmsg)})},again:function(){this.$router.push({path:"/goods"})}},components:{loading:ne["default"]}},qe=De,Ee=(i("044c"),Object(m["a"])(qe,Pe,$e,!1,null,"4ae772b8",null));Ee.options.__file="orderInfo.vue";var Oe=Ee.exports,Te=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"orderList"},[i("div",{ref:"orderListBox",staticClass:"orderListBox"},[i("ul",t._l(t.data,function(e,o){return i("li",{key:o,on:{click:function(i){t.orderInfo(e.id)}}},[i("div",[i("span",[i("b",[t._v(t._s(e.itemList[0].dishName)+t._s(e.itemList.length>1?"等菜品":""))])])]),i("div",[i("span",[i("b",[t._v("订单号:")]),t._v(t._s(e.id))]),i("span",[t._v(t._s(e.createdAtStr))])]),i("div",[t._m(0,!0),i("span",[t._v(t._s(e.netOrderStatusStr))])]),i("div",[i("span",[i("b",[t._v("总价:")]),t._v("￥"+t._s(e.total))])]),i("div",[i("span",[i("b",[t._v("实付:")]),t._v("￥"+t._s(e.cost))])])])}))]),i("button",{staticClass:"btn",on:{click:t.again}},[t._v("再来一单")]),t.loading?i("loading"):t._e()],1)},Me=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("b",[t._v("订单状态:")])])}],je={data:function(){return{loading:!1,data:{}}},activated:function(){this.componentDidMount()},methods:{componentDidMount:function(){var t=this;this.loading=!0,r.a.post("../../wx/getNetOrder",d.a.stringify({appid:localStorage.getItem("appid"),brandid:parseInt(localStorage.getItem("brandid")),orderType:1,openid:window.sessionStorage.getItem("openid")})).then(function(e){t.loading=!1;var i=e.data;0==i.result?(t.data=i.content,t.$nextTick(function(){t.scroll||(t.scroll=new rt["a"](t.$refs.orderListBox,{click:!0}))})):alert(i.errmsg)})},again:function(){this.$router.push({path:"/goods"})},orderInfo:function(t){this.$router.push({path:"/orderInfo",query:{orderid:t}})}},components:{loading:ne["default"]}},Ae=je,Be=(i("5f33"),Object(m["a"])(Ae,Te,Me,!1,null,"747193da",null));Be.options.__file="orderList.vue";var Ue=Be.exports,Re=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"orderList"},[i("div",{ref:"orderListBox",staticClass:"orderListBox"},[i("ul",t._l(t.data,function(e,o){return i("li",{key:o,on:{click:function(i){t.orderInfo(e.id)}}},[i("div",[i("span",[i("b",[t._v(t._s(e.itemList[0].dishName)+t._s(e.itemList.length>1?"等菜品":""))])])]),i("div",[i("span",[i("b",[t._v("订单号:")]),t._v("\n            "+t._s(e.id)+"\n          ")]),i("span",[t._v(t._s(e.createdAtStr))])]),i("div",[t._m(0,!0),i("span",[t._v(t._s(e.netOrderStatusStr))])]),i("div",[i("span",[i("b",[t._v("总价:")]),t._v("\n            ￥"+t._s(e.total)+"\n          ")])]),i("div",[i("span",[i("b",[t._v("实付:")]),t._v("\n            ￥"+t._s(e.cost)+"\n          ")])])])}))]),i("button",{staticClass:"btn",on:{click:t.again}},[t._v("再来一单")]),t.loading?i("loading"):t._e()],1)},ze=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("b",[t._v("订单状态:")])])}],Ke={data:function(){return{loading:!1,data:{}}},activated:function(){this.componentDidMount()},methods:{componentDidMount:function(){var t=this;this.loading=!0,r.a.post("../../wx/findOrder",d.a.stringify({appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),openid:window.sessionStorage.getItem("openid"),brandid:window.localStorage.getItem("brandid")})).then(function(e){t.loading=!1;var i=e.data;0==i.result?(t.data=i.content,i.content.length>0&&i.content.forEach(function(t){window.sessionStorage.setItem("phoneNum",t.memberPhoneNumber)}),t.$nextTick(function(){t.scroll||(t.scroll=new rt["a"](t.$refs.orderListBox,{click:!0}))})):alert(i.errmsg)})},again:function(){this.$router.push({path:"/goods"})},orderInfo:function(t){this.$router.push({path:"/orderInfo",query:{orderid:t}})}},components:{loading:ne["default"]}},We=Ke,He=(i("bc6b"),Object(m["a"])(We,Re,ze,!1,null,"4ec873d9",null));He.options.__file="orderListAgain.vue";var Je=He.exports,Ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"addressList"},[i("div",{staticClass:"nav"},[i("div",{staticClass:"nav-left",on:{click:t.routerback}},[i("i",{staticClass:"iconfont"},[t._v("")])]),i("h2",[t._v("选择收货地址")]),i("div",{staticClass:"add",on:{click:function(e){t.addEdit("add")}}},[t._v("新增地址")])]),i("div",{ref:"list",staticClass:"list"},[i("div",{staticClass:"roll"},[t.available.length>0?i("div",[i("ul",t._l(t.available,function(e,o){return e?i("li",{key:o,on:{click:function(i){t.addSet(e)}}},[i("div",{staticClass:"address"},[t._v(t._s(e.address))]),i("div",{staticClass:"detailed"},[t._v(t._s(e.detail))]),i("div",{staticClass:"name"},[t._v(t._s(e.customer)+" "+t._s(e.phone))]),i("div",{staticClass:"icon-edit-1-copy iconfont edit",on:{click:function(i){i.stopPropagation(),t.addEdit(e)}}}),i("div",{staticClass:"icon-shanchu iconfont del",on:{click:function(i){i.stopPropagation(),t.del(e.id)}}})]):t._e()}))]):t._e(),t.beyond.length>0?i("div",{staticClass:"split"}):t._e(),t.beyond.length>0?i("div",{staticClass:"beyond"},[i("h2",[t._v("以下地址超出配送范围")]),i("ul",t._l(t.beyond,function(e,o){return e?i("li",{key:o},[i("div",{staticClass:"address"},[t._v(t._s(e.address))]),i("div",{staticClass:"detailed"},[t._v(t._s(e.detail))]),i("div",{staticClass:"name"},[t._v(t._s(e.customer)+" "+t._s(e.phone))]),i("div",{staticClass:"icon-edit-1-copy iconfont edit",on:{click:function(i){t.addEdit(e)}}}),i("div",{staticClass:"icon-shanchu iconfont del",on:{click:function(i){t.del(e.id)}}})]):t._e()}))]):t._e(),!t.beyond.length>0&&!t.available.length>0?i("div",{staticClass:"addnew",on:{click:function(e){t.addEdit("add")}}},[t._v("请添加收货地址")]):t._e()])]),i("el-amap",{staticClass:"amap"}),i("loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],1)},Ye=[],Xe={data:function(){return{loading:!1,available:[],beyond:[]}},activated:function(){var t=this;this.getList(),this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.list,{click:!0})})},methods:Object(St["a"])({},Object(xt["c"])(["set_addressInfo"]),{routerback:function(){return window.history.length<=1?(this.$router.push({path:"/"}),!1):(this.$router.go(-1),!1)},getList:function(){var t=this;this.available=[],this.beyond=[];var e={appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),customerid:window.sessionStorage.getItem("openid")};this.loading=!0,r.a.post("../../wx/getDeliverCustomerInfoByCustomerid",d.a.stringify(e)).then(function(e){if(t.loading=!1,0==e.data.result){var i=e.data.content,o=window.localStorage.getItem("point").split(",");AMap&&i.forEach(function(e){if(e.xy=JSON.parse(e.xy),e.xy instanceof Array){var i=AMap.GeometryUtil.distance(o,e.xy);i<3e3?t.available.push(e):t.beyond.push(e)}})}})},addEdit:function(t){this.$router.push({path:"/addressEdit",query:t})},del:function(t){var e=this,i={appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),customerid:window.sessionStorage.getItem("openid"),id:t};r.a.post("../../wx/deleteDeliverCustomerInfo",d.a.stringify(i)).then(function(t){e.getList()})},addSet:function(t){this.update(t),this.set_addressInfo(t),this.$router.push({path:"/payPage"})},update:function(t){t.defaultCheck=1,t.xy=JSON.stringify(t.xy),r.a.post("../../wx/updateDeliverCustomerInfo",d.a.stringify(t))}}),components:{loading:ne["default"]}},Qe=Xe,Ze=(i("b473"),Object(m["a"])(Qe,Ge,Ye,!1,null,"1c8a3721",null));Ze.options.__file="addressList.vue";var Ve=Ze.exports,ti=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"addressEdit"},[i("navTop",{attrs:{title:t.title}}),i("ul",[i("li",[i("span",[t._v("联系人")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.customer,expression:"customer"}],attrs:{type:"text",placeholder:"姓名"},domProps:{value:t.customer},on:{input:function(e){e.target.composing||(t.customer=e.target.value)}}})]),i("li",[i("span",[t._v("电话")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"number",min:"11",max:"11",placeholder:"手机号码"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),i("li",[i("span",[t._v("地址")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.mapInfo.address,expression:"mapInfo.address"}],attrs:{type:"text",placeholder:"选择收货地址",readonly:""},domProps:{value:t.mapInfo.address},on:{click:t.mapShow,input:function(e){e.target.composing||t.$set(t.mapInfo,"address",e.target.value)}}})]),i("li",[i("span",[t._v("门牌号")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.detail,expression:"detail"}],attrs:{type:"text",placeholder:"例：5号楼203室"},domProps:{value:t.detail},on:{input:function(e){e.target.composing||(t.detail=e.target.value)}}})])]),i("button",{staticClass:"btn",on:{click:t.submit}},[t._v("保存并使用")]),i("tmpmap",{ref:"map",on:{mapInfo:t._mapInfo}}),t.loading?i("loading"):t._e()],1)},ei=[],ii=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"_map"},[i("div",{staticClass:"nav"},[i("div",{staticClass:"nav-left",on:{click:t.routerback}},[i("i",{staticClass:"iconfont"},[t._v("")])]),i("h2",[t._v(t._s(t.title))])]),i("div",{staticClass:"amap-page-container"},[i("el-amap-search-box",{staticClass:"search-box",attrs:{"search-option":t.searchOption,"on-search-result":t.onSearchResult}}),i("el-amap",{ref:"map",staticClass:"amap-demo",attrs:{vid:"amapDemo",plugin:t.plugin,zoom:t.zoom,center:t.center,events:t.events}},[i("el-amap-marker",{attrs:{vid:"component-marker",position:t.makerConf.position,content:t.makerConf.content}})],1)],1),i("div",{ref:"adrs",staticClass:"adrs"},[i("ul",t._l(t.list,function(e,o){return i("li",{key:o,class:t.currIndex==o?"active":"",on:{click:function(i){t.select(e,o)}}},[t.currIndex==o?i("span",{staticClass:"iconfont"},[i("img",{attrs:{src:"https://webapi.amap.com/theme/v1.3/markers/b/mark_bs.png",alt:""}})]):i("span",{staticClass:"iconfont icon-quanzi"}),i("p",{staticClass:"address"},[t._v(t._s(e.address))]),i("p",{staticClass:"address"},[t._v(t._s(e.name))])])}))])])},oi=[],si={components:{navTop:g},data:function(){var t=this;return t.city=t.city||"深圳",{showFlag:!1,title:"确认收货地址",list:[],Search:"深圳",currIndex:0,zoom:16,center:[114.076261,22.545037],lng:0,lat:0,events:{init:function(e){e.setCity(t.city,function(e){e&&e.length>0&&(console.log(t.zoom),t.zoom=16,t.makerConf.position=e,t.getList(e))}),document.getElementsByClassName("amap-logo")[0].style.display="none",document.getElementsByClassName("amap-copyright")[0].style.visibility="hidden"},movestart:function(t){document.getElementsByClassName("amap-icon")[0].style.top="-10px"},mapmove:function(e){var i=this.getCenter();t.makerConf.position=[i.lng,i.lat]},moveend:function(e){var i=this.getCenter(),o=[i.lng,i.lat];t.makerConf.position=[i.lng,i.lat],document.getElementsByClassName("amap-icon")[0].style.top="0",t.getList(o)}},makerConf:{position:[114.076261,22.545037],content:""},searchOption:{city:t.city,citylimit:!0},plugin:[{pName:"Geolocation",events:{init:function(e){e.getCurrentPosition(function(e,i){i&&i.position&&(t.zoom=17,t.lng=i.position.lng,t.lat=i.position.lat,t.center=[t.lng,t.lat],t.$nextTick())})},complete:function(e){console.log(e);var i=e.formattedAddress,o=e.position,s={address:i,name:"",location:o};t.list=[s],t.makerConf.position=[o.lng,o.lat]},error:function(){}}}]}},mounted:function(){var t=this;this.$nextTick(function(){t.scroll?t.scroll.refresh():t.scroll=new rt["a"](t.$refs.adrs,{click:!0})})},methods:{show:function(){this.showFlag=!0},routerback:function(){this.showFlag=!1},select:function(t,e){var i=this;i.currIndex=e;var o=t.location;i.makerConf.position=[o.lng,o.lat],i.center=[o.lng,o.lat],this.showFlag=!1;var s={address:t.address,location:[o.lng,o.lat]};this.$emit("mapInfo",s)},getList:function(t){var e=this;e.$Geocoder({lnglatXY:t,success:function(t){t.regeocode&&t.regeocode.pois?e.list=t.regeocode.pois:e.list=[]},error:function(t){e.list=[]}}),this.scroll.refresh()},onSearchResult:function(t){var e=this;e.$refs.map.$$getInstance();if(t&&t.length>0){var i=t[0],o=i["lng"],s=i["lat"];e.center=[o,s],e.makerConf.position=[o,s],e.list=t}else e.list=[];this.scroll.refresh()},$Geocoder:function(t){t=t||{},AMap&&AMap.plugin(["AMap.Geocoder"],function(){var e=new AMap.Geocoder({radius:t.radius||1e3,extensions:t.extensions||"all"}),i=t.lnglatXY||[114.397169,30.50576];e.getAddress(i,function(e,i){"complete"===e&&"OK"===i.info?t.success&&t.success(i):t.error&&t.error(e,i)})})}},watch:{list:function(){this.currIndex=0}}},ai=si,ni=(i("e51d"),Object(m["a"])(ai,ii,oi,!1,null,"9c1fd822",null));ni.options.__file="map.vue";var ri=ni.exports,ci={data:function(){return{title:"填写收货信息",loading:!1,mapInfo:{address:""},customer:"",phone:"",detail:""}},created:function(){if(this.$route.query.customer){var t=this.$route.query;console.log(t),this.customer=t.customer,this.phone=t.phone,this.detail=t.detail,this.mapInfo={address:t.address,location:t.xy}}},methods:Object(St["a"])({},Object(xt["c"])(["set_addressInfo"]),{mapShow:function(){this.$refs.map.show()},_mapInfo:function(t){this.mapInfo=t},submit:function(){var t=this;if(!this.customer.length>0)return Object(at["Toast"])({className:"toasts",message:"请填写联系人姓名"}),!1;if(!/^1[34578]\d{9}$/.test(this.phone))return Object(at["Toast"])({className:"toasts",message:"手机号码有误,请重填"}),!1;if(!this.mapInfo.address.length>0)return Object(at["Toast"])({className:"toasts",message:"选择收货地址"}),!1;if(!this.detail.length>0)return Object(at["Toast"])({className:"toasts",message:"请填写门牌号"}),!1;var e={appid:window.localStorage.getItem("appid"),storeid:window.localStorage.getItem("storeid"),customerid:window.sessionStorage.getItem("openid"),customer:this.customer,phone:this.phone,address:this.mapInfo.address,detail:this.detail,xy:JSON.stringify(this.mapInfo.location),id:this.$route.query.id,defaultCheck:1};this.loading=!0,r.a.post("../../wx/updateDeliverCustomerInfo",d.a.stringify(e)).then(function(i){t.loading=!1,0==i.data.result&&(t.set_addressInfo(e),t.$router.push({path:"/payPage"}))})}}),components:{navTop:g,tmpmap:ri,loading:ne["default"]}},di=ci,li=(i("dc6d"),Object(m["a"])(di,ti,ei,!1,null,"f14b0a68",null));li.options.__file="addressEdit.vue";var ui=li.exports;o["default"].use(G["a"]);var hi=[{path:"/welcome",component:tt,meta:{title:"欢迎"}},{path:"/goods",component:ue,name:"goods",meta:{keepAlive:!0}},{path:"/payPage",component:Ie,name:"payPage"},{path:"/paySuccess",component:Ne,name:"paySuccess"},{path:"/orderInfo",component:Oe,name:"orderInfo"},{path:"/orderList",component:Ue,name:"orderList"},{path:"/orderListAgain",component:Je,name:"orderListAgain"},{path:"/addressList",component:Ve,name:"addressList"},{path:"/addressEdit",component:ui,name:"addressEdit"}],pi=new G["a"]({linkActiveClass:"active",routes:hi,base:"/wxdc/dist/"}),mi=(i("aa35"),i("2c49"),i("499a"),i("8f9b")),fi=i.n(mi);i("0fae"),i("a287");o["default"].use(fi.a),fi.a.initAMapApiLoader({key:"d14ad4c473160cbc9a6aef971e2d6a11",plugin:["AMap.Geolocation"]}),o["default"].use(xt["a"]),o["default"].config.productionTip=!1,o["default"].use(nt.a),new o["default"]({router:pi,store:Pt,render:function(t){return t(J)}}).$mount("#app")},"5c48":function(t,e,i){},"5c52":function(t,e,i){"use strict";var o=i("6409"),s=i.n(o);s.a},"5f33":function(t,e,i){"use strict";var o=i("cd94"),s=i.n(o);s.a},6409:function(t,e,i){},"6c23":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"aligncenter"},[i("div",{staticClass:"spinner"},[i("div",{staticClass:"rect1"}),i("div",{staticClass:"rect2"}),i("div",{staticClass:"rect3"}),i("div",{staticClass:"rect4"}),i("div",{staticClass:"rect5"})])])}];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return s})},"6d40":function(t,e,i){"use strict";var o=i("e74b"),s=i.n(o);s.a},"72d0":function(t,e,i){"use strict";var o=i("a5b0"),s=i.n(o);s.a},7727:function(t,e,i){},7911:function(t,e,i){},"7c55":function(t,e,i){"use strict";var o=i("5c48"),s=i.n(o);s.a},"81fc":function(t,e,i){},8348:function(t,e,i){},"8e13":function(t,e,i){},9091:function(t,e,i){},"96f7":function(t,e,i){"use strict";var o=i("b7d2"),s=i.n(o);e["default"]=s.a},"9b6b":function(t,e,i){},a287:function(t,e,i){},a5b0:function(t,e,i){},b315:function(t,e,i){"use strict";var o=i("8348"),s=i.n(o);s.a},b473:function(t,e,i){"use strict";var o=i("0409"),s=i.n(o);s.a},b504:function(t,e,i){},b7d2:function(t,e){},bc6b:function(t,e,i){"use strict";var o=i("8e13"),s=i.n(o);s.a},c4c2:function(t,e,i){},c56a:function(t,e,i){"use strict";var o=i("c761"),s=i.n(o);s.a},c761:function(t,e,i){},cd94:function(t,e,i){},dc6d:function(t,e,i){"use strict";var o=i("7727"),s=i.n(o);s.a},e0e4:function(t,e,i){t.exports=i.p+"img/no.d77dab99.png"},e51d:function(t,e,i){"use strict";var o=i("b504"),s=i.n(o);s.a},e673:function(t,e,i){"use strict";var o=i("e8fb"),s=i.n(o);s.a},e74b:function(t,e,i){},e8fb:function(t,e,i){},f371:function(t,e,i){"use strict";var o=i("4d52"),s=i.n(o);s.a},fd78:function(t,e,i){"use strict";var o=i("81fc"),s=i.n(o);s.a}});
//# sourceMappingURL=app.a682db43.js.map